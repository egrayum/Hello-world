<html>
  <head>
    <canvas id="gameCanvas" style="width: 100%; height: 100%; background: #6e6e6e; text-align: center;"></canvas>
    <script>
    var c = document.getElementById("gameCanvas");
    var ctx = c.getContext("2d");
    var i;
    var j;
    var c;
    var jump = false;
    var interval;
    var level = 1;
    var collectibles = 0;
    var jumpheight = 3; // jump height
    var rows = [];
    // map
    function levelData() {
      if (level == 1) {
        rows[0] = ["a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a"];
        rows[1] = ["a","0","a","a","a","a","0","0","0","a","a","0","0","a","a","a","0","a","a","0","0","a"];
        rows[2] = ["a","0","0","a","a","0","0","0","0","0","0","0","0","0","a","a","0","0","0","0","0","0"];
        rows[3] = ["a","0","a","a","0","0","a","a","0","a","a","0","a","a","a","a","a","0","0","a","0","0"];
        rows[4] = ["a","0","0","0","0","0","0","0","0","a","0","0","0","a","b","a","0","0","0","0","0","a"];
        rows[5] = ["a","a","0","0","0","a","0","0","0","a","0","a","0","0","0","a","0","0","0","a","a","a"];
        rows[6] = ["a","a","a","0","0","0","0","a","a","a","a","a","a","a","a","a","a","a","0","0","0","a"];
        rows[7] = ["a","0","a","0","0","0","a","a","0","0","0","0","0","a","a","a","a","a","a","a","0","a"];
        rows[8] = ["a","a","a","a","0","a","a","a","a","0","a","a","0","a","a","a","a","a","a","0","0","a"];
        rows[9] = ["a","a","0","0","0","0","0","0","a","0","0","a","0","0","a","0","0","0","0","0","a","a"];
        rows[10] = ["a","0","0","0","a","a","0","a","a","a","0","a","a","0","a","0","a","a","0","0","0","a"];
        rows[11] = ["a","0","a","a","a","0","0","a","a","0","0","a","0","0","a","0","0","a","0","a","0","a"];
        rows[12] = ["a","0","0","0","0","0","a","a","0","0","a","a","0","a","a","a","0","a","0","0","0","a"];
        rows[13] = ["a","a","0","0","0","0","0","0","0","a","a","0","0","0","0","0","0","a","a","a","a","a"];
        rows[14] = ["a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a"];
      } else if (level == 2) {
        rows[0] = ["a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a"];
        rows[1] = ["a","a","0","a","a","a","a","a","a","a","0","a","a","0","a","a","0","0","0","a","f","f"];
        rows[2] = ["a","0","0","0","a","a","0","a","0","a","0","0","0","0","0","0","0","a","0","a","f","a"];
        rows[3] = ["a","0","a","a","a","0","0","0","0","0","0","0","a","a","a","0","a","0","0","0","f","a"];
        rows[4] = ["a","0","a","a","0","0","0","0","a","a","0","a","a","a","a","a","a","0","a","0","a","a"];
        rows[5] = ["a","0","a","a","a","0","a","0","0","a","0","0","0","a","a","a","0","0","0","0","0","a"];
        rows[6] = ["a","0","a","a","a","a","a","a","0","a","a","a","0","0","0","a","0","a","a","a","0","a"];
        rows[7] = ["a","0","0","a","a","0","0","0","0","0","a","0","0","0","0","0","0","a","0","0","0","a"];
        rows[8] = ["a","a","0","a","a","0","0","a","a","a","a","0","a","a","0","a","a","a","0","a","a","a"];
        rows[9] = ["a","a","0","a","a","a","0","0","0","a","a","0","0","a","0","a","a","0","0","0","a","a"];
        rows[10] = ["a","0","0","a","0","a","a","0","a","a","a","a","0","0","0","a","a","0","a","0","0","a"];
        rows[11] = ["a","0","0","0","0","0","a","0","0","a","a","a","a","0","a","a","0","0","0","0","0","0"];
        rows[12] = ["a","0","0","a","0","0","a","a","0","a","a","a","a","b","f","0","0","0","0","0","0","0"];
        rows[13] = ["a","a","0","a","a","0","0","0","0","a","a","a","a","a","a","a","l","l","a","a","0","a"];
        rows[14] = ["a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a"];
      } else if (level == 3) {
        rows[0] = ["a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a"];
        rows[1] = ["a","0","0","0","0","a","a","a","0","0","0","a","a","a","0","a","a","a","0","a","0","0"];
        rows[2] = ["a","0","0","a","0","a","a","0","0","a","0","a","a","0","0","0","a","0","0","0","0","a"];
        rows[3] = ["a","a","a","a","0","a","a","0","a","a","0","0","0","0","0","0","0","0","a","0","a","a"];
        rows[4] = ["a","0","0","0","0","a","a","0","0","a","a","0","0","0","0","0","0","a","a","a","a","a"];
        rows[5] = ["a","0","a","a","0","a","a","a","0","a","a","a","a","a","a","0","0","0","0","a","a","a"];
        rows[6] = ["a","0","0","0","a","a","a","a","0","0","0","a","a","a","a","a","a","a","0","0","0","a"];
        rows[7] = ["a","a","a","0","a","a","a","a","a","0","0","0","0","0","a","a","a","a","a","a","0","a"];
        rows[8] = ["a","0","0","0","a","0","0","0","a","a","0","0","a","0","a","a","0","b","a","a","0","a"];
        rows[9] = ["a","0","a","a","a","0","0","0","a","0","0","a","a","0","a","a","0","0","0","a","0","a"];
        rows[10] = ["a","0","0","0","0","0","0","0","0","0","a","a","0","0","a","a","a","0","0","0","0","a"];
        rows[11] = ["a","a","a","a","a","a","0","0","a","a","0","0","0","a","a","a","a","0","a","a","a","a"];
        rows[12] = ["a","a","a","0","0","0","0","0","0","a","0","a","a","a","a","a","0","0","f","a","f","f"];
        rows[13] = ["a","a","a","l","l","l","l","l","l","a","0","0","0","0","0","0","0","a","f","f","f","a"];
        rows[14] = ["a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a","a"];
      }
    }
    var p = {
      x: 2,
      y: 2
    }
    function setjump() {
      jump = false;
    }
    function jumpy() {
      jump = true;
      upone();
      window.setTimeout(upone, 75);
      function upone() {
        if (rows[p.y - 1][p.x] != "a") {
          p.y -= 1;
        }
      }
      window.setTimeout(setjump, 200);
    }
    document.addEventListener("keydown", function(event) {
      if (event.keyCode == 37) {
        if (rows[p.y][p.x - 1] != "a") {
          p.x -= 1;
        }
      }
      if (event.keyCode == 39) {
        if (rows[p.y][p.x + 1] != "a") {
          p.x += 1;
        };
      }
      if (event.keyCode == 38 && rows[p.y + 1][p.x] == "a") {
        jumpy();
      }
    })
    function fall() {
      if (rows[p.y + 1][p.x] != "a" && jump == false) {
        p.y += 1;
      }
    }
    function renderCanvas() {
      ctx.fillStyle = "#618291";
      ctx.fillRect(0, 0, c.width, c.height);
    }
    function renderMap() {
      ctx.fillStyle = "#1362a3";
      ctx.fillRect(70 + (p.x * 30), 70 + (p.y * 30), 30, 30);
      for (i = 0; i < rows.length; i ++) {
        for (j = 0; j < rows[i].length; j++) {
          if (rows[i][j] == "a") { // block
            ctx.fillStyle = "#000";
            ctx.fillRect(70 + (j * 30), 70 + (i * 30), 30, 30);
          } else if (rows[i][j] == "b") { // berry
            ctx.fillStyle = "#116101";
            ctx.fillRect(75 + (j * 30), 75 + (i * 30), 20, 20);
          } else if (rows[i][j] == "f") { // fake block
            ctx.fillStyle = "#090909";
            ctx.fillRect(70 + (j * 30), 70 + (i * 30), 30, 30);
          } else if (rows[i][j] == "l") { // lava
            ctx.fillStyle = "#ff0000";
            ctx.fillRect(70 + (j * 30), 80 + (i * 30), 30, 20);
          }
        }
      }
    }
    function update() {
      renderCanvas();
      renderMap();
      if (p.x == 21) {
        p.x = 2;
        p.y = 2;
        level++;
        levelData();
      }
      if (rows[p.y][p.x] == "b") {
        rows[p.y][p.x] = "0";
        collectibles++;
      }
      if (rows[p.y][p.x] == "l") {
        p.x = 2;
        p.y = 2;
      }
    }
    // set canvas size and stuff
    function init() {
      c.width = 800;
      c.height = 600;
      levelData();
      renderCanvas();
      renderMap();
      window.setInterval(update, 20);
      interval = window.setInterval(fall, 100);
    }
    </script>
  </head>
  <body onload="init()">
  </body>
</html>
